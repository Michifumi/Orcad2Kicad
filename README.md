# "Orcad2Kicad"について   


##Ａ.概要 

+ "Orcad2Kicad.py"は、KiCADv4の基板設計ソフトPcbnewで動作するマクロプログラムであり、OrCADのネットリストファイルを入力し、Pcbnew用ネットリストを出力するソフトです。


##Ｂ.ファイル内容 
1. "Orcad2Kicad.py" ... OrCADからKiCAD用ネットリスト変換ソフト（マクロ）
2. "calay.net"      ... サンプルCalayネットリスト
3. "partlist.csv"   ... サンプル部品情報ファイル


##Ｃ.動作確認環境 

+ KiCAD Ver4.07 on Windows7-64bit　/ Ubuntu14.04LTS-64bit  


##Ｄ.使用方法 
1. OrCADで、ネットリストフォーマットを"Calay"選択し、ファイル名"calay.net"で、ネットリストを作成する。
2. このファイルを、KiCADのこれから編集する基板設計フォルダーへ、コピーする。
3. Pcbnewを起動し、Pythonコンソールを選択実行する。　
4. コンソール内で、「pwd」を実行し、出てきたフォルダ（普通は"C:\Program Files\KiCad")へ、本ソフト"Orcad2Kicad.py"をコピーする。
5. コンソール内で、「execfile("Orcad2Kicad.py")」と入力、実行する。
6. Pcbnew用ネットリスト**（自動的に「プロジェクト名」+ ".net"に設定）**ファイルが生成される。尚、生成されたファイルは、部品パッドが各部品最大ピン数のピンヘッダ**やQFPパッケージ**を自動的に割り当てられる。
7. そのネットリストをインポートします。　その後、部品パッドを変更すれば、基板設計できます。
8. 上記7までの方法は部品一品毎に変更なので部品が多いと面倒です。それで、部番と部品パッド情報をcsvファイルで用意できれば、それを使っても、KiCAD用ネットリストを作成できます。  
+部番と部品パッド情報のcsvファイル名"partlist.csv"として、添付サンプルを参考に、今編集している基板設計フォルダーで、作成してください。    
+この状態で、上記5と同じようにコンソール内で、「execfile("Orcad2Kicad.py")」と入力実行すると、プログラムは、自動的に"partlist.csv"を検出し、このファイルを使ってネットリストが生成されます。


##Ｅ.その他 
1. **パーツリストを使わない場合は、OrCADのネットリストのピン番号を、数字だけにし、英文字を含まない事。（トランジスタ等の"BCE"やBGAパッケージの"A10"等は、NG）。　又、その時の最大ピン番号は256までで、それ以上のネット接続情報は失われてしまうので注意してください。**  
2. 他に生成されるファイル"NET.TXT"は、ネットリストが正しく認識されたかを確認する為のものです。  
3. Pcbnewで部品パッドを変更する方法は、部品選択後 -> "e"を押して「プロパティ」 -> 「フットプリントの変更」 -> 「フットプリントの表示」です。尚、部品定数は、「部番記号」:「最大ピン数」（例："C:2"）になっていますので、「フットプリントの変更」の「オプション」を使って、抵抗・コンデンサ等をまとめてパッド変換可能です。  
4. 本プロジェクトは、動作環境Jupyter Notebook版である「PcbNetList」プロジェクトの機能縮小版です。


##Ｆ.参考にさせて頂いたサイト 
+ 「KiCad用のPythonスクリプト ～ ほぼ回路図の配置通りにフットプリントを予備配置する」
        <https://qiita.com/silvermoon/items/da4fcdba319f46570a60>


##Ｇ.変更履歴 
---
***2017/10/30   (3rd commit)  
1. 部品パッドのピンヘッダ自動割り当ては80ピンまでとし、それ以上はQFPパッケージの100/208/256ピンへ変更した。  
2. 部品の最大ピン数41〜80ピンの時は、２列のピンヘッダが自動的に割り当てられるが、奇数ピンの時、１個少ないピン数だったのを1個多いピン数のピンヘッダにするようにした。  
3. 出力ネットファイル名は、"kicad.net"から、自動的に「プロジェクト名」+ ".net"に設定されるよう変更した。***

---
2017/10/22   (2nd commit)  
1. ファイル解析処理中にある改行削除で、'\\n'だけだったのを'\\r'も削除するようにした。  
2. csvファイル処理をNumpyライブラリーからcsvライブラリーへ変更した。これにより、「部番と部品パッド情報のcsvファイルを使ってのネットリスト作成する機能」にも対応できるようにした。  
3. プログラムを、終了時のファルダー位置が、起動した時の位置に戻すように変更した。      
4. Linuxでも動作を確認した所、問題がなかった。 

---
2017/10/20   (1st commit)
      
---
  
