#"Orcad2Kicad"について


##Ａ.概要

+ "Orcad2Kicad.py"は、KiCADv4の基板設計ソフトPcbnewで動作するマクロプログラムであり、OrCADのネットリストファイルを入力し、Pcbnew用ネットリストを出力するソフトです。


##Ｂ.ファイル内容
1. "Orcad2Kicad.py" ... OrCADからKiCAD用ネットリスト変換ソフト（マクロ）
2. "calay.net"    ... サンプルCalayネットリスト

 
##Ｃ.動作確認環境

+ KiCAD Ver4.07 on Windows7-64bit　（Linux版では動作しません） 


##Ｄ.使用方法
1. OrCADで、ネットリストフォーマットを"Calay"選択し、ファイル名"calay.net"で、ネットリストを作成する。
2. このファイルを、KiCADのこれから編集するフォルダーへ、コピーする。
3. Pcbnewを起動し、Pythonコンソールを選択実行する。　
4. コンソール内で、「pwd」を実行し、出てきたフォルダ（普通は"C:\Program Files\KiCad")へ、本ソフト"Orcad2Kicad.py"をコピーする。
5. コンソール内で、「execfile("Orcad2Kicad.py")」と入力、実行する。
6. "kicad.net"ファイルが生成される。尚、生成されたファイルは、部品パッドが各部品最大ピン数のピンヘッダを自動的に割り当てられる。
7. そのネットリストをインポートします。　その後、部品パッドを変更すれば、基板設計できます。


##Ｅ.その他
1. 他に生成されるファイル"NET.TXT"は、ネットリストが正しく認識されたかを確認する為のものです。
2. Pcbnewで部品パッドを変更する方法は、部品選択後 -> "e"を押して「プロパティ」 -> 「フットプリントの変更」 -> 「フットプリントの表示」です。尚、部品定数は、「部番記号」:「最大ピン数」（例："C:2"）になっていますので、「フットプリントの変更」の「オプション」を使って、抵抗・コンデンサ等をまとめてパッド変換可能です。
3. 本プロジェクトは、動作環境Jupyter Notebook版である「PcbNetList」プロジェクトの機能縮小版です。
4. KiCAD ver4.07のPython2.7には、Numpyライブラリーが含まれていません。この為、csvファイルを読み込む関数が使えないので、「PcbNetList」プロジェクトにあった「部番と部品パッド情報のcsvファイルを使ってのネットリスト作成する機能」は使えません。（ただし、将来KiCADがPython3へ移行する事を考えてあえてプログラムは残しています）


##Ｆ.参考にさせて頂いたサイト
+ 「KiCad用のPythonスクリプト ～ ほぼ回路図の配置通りにフットプリントを予備配置する」
        https://qiita.com/silvermoon/items/da4fcdba319f46570a60
